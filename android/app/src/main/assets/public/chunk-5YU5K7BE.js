import{a as $,h as j,q as H}from"./chunk-TIRIOUTJ.js";import{a as B}from"./chunk-CAWAZEOC.js";import{d as y,i as S,k as E,l as T,m as z,n as k,s as D,t as L,u as F,x as A,y as N}from"./chunk-AYIUP6ED.js";import{$ as s,A as u,E as d,H as p,I as o,J as e,K as h,R as x,S as g,aa as f,ba as m,ga as O,ha as P,ka as M,la as v,na as I,oa as w,v as C,w as a,y as b}from"./chunk-5MEF2J7Q.js";import"./chunk-W7HPUEKP.js";import"./chunk-5UWQKTRJ.js";import"./chunk-254F5RPF.js";import"./chunk-PZU7R7Y5.js";import"./chunk-YN4SZ4GL.js";import"./chunk-UQSJFG5S.js";import"./chunk-O6FA337S.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{f as _}from"./chunk-D7YYRZS5.js";function q(i,l){if(i&1&&(o(0,"div",16)(1,"span",17),s(2),e(),o(3,"span",18),s(4),O(5,"number"),e()()),i&2){let t=g().$implicit;a(2),m("",t.precio_original,"\u20AC"),a(2),m("Ahorra: ",P(5,2,t.precio_original-t.precio_actual,"1.2-2"),"\u20AC")}}function G(i,l){if(i&1&&(o(0,"ion-badge",19),s(1),e()),i&2){let t=g().$implicit,n=g();a(),m(" -",n.calcDescuento(t),"% ")}}function J(i,l){if(i&1&&(o(0,"ion-item",5)(1,"ion-thumbnail",6),h(2,"img",7),e(),o(3,"ion-label")(4,"h2"),s(5),e(),o(6,"p",8),h(7,"ion-icon",9),o(8,"span",10),s(9),e()(),o(10,"p",11),s(11),e(),o(12,"div",12)(13,"span",13),s(14),e(),d(15,q,6,5,"div",14),e()(),d(16,G,2,1,"ion-badge",15),e()),i&2){let t=l.$implicit,n=g();a(2),p("src",t.imagen_url||"assets/placeholder.png",C),a(3),f(t.titulo),a(4),f((t.proveedores==null?null:t.proveedores.nombre)||"Tienda"),a(2),f(t.descripcion),a(3),m("",t.precio_actual,"\u20AC"),a(),p("ngIf",t.precio_original&&t.precio_original>t.precio_actual),a(),p("ngIf",n.calcDescuento(t)>0)}}var nn=(()=>{let l=class l{constructor(n){this.supabaseService=n,this.listadoChollos=[],this.filtrados=[],$({storefrontOutline:H,informationCircleOutline:j})}ngOnInit(){return _(this,null,function*(){yield this.cargarChollos()})}cargarChollos(){return _(this,null,function*(){try{let n=yield this.supabaseService.getChollos();console.log("Datos recibidos:",n),this.listadoChollos=n,this.filtrados=[...n]}catch(n){console.error("Error en Tab Chollos:",n)}})}calcDescuento(n){let r=Number(n?.precio_actual||0),c=Number(n?.precio_original||0);return!r||!c||c<=r?0:Math.round((c-r)/c*100)}buscar(n){let r=(n.target.value||"").toLowerCase().trim();if(!r){this.filtrados=[...this.listadoChollos];return}this.filtrados=this.listadoChollos.filter(c=>c.titulo.toLowerCase().includes(r)||c.proveedores?.nombre?.toLowerCase().includes(r))}};l.\u0275fac=function(r){return new(r||l)(b(B))},l.\u0275cmp=u({type:l,selectors:[["app-tab4"]],decls:9,vars:1,consts:[[1,"ion-no-border"],["color","primary"],["placeholder","Buscar ofertas...",3,"ionInput"],["lines","full"],["class","chollo-item",4,"ngFor","ngForOf"],[1,"chollo-item"],["slot","start"],[3,"src"],[1,"info-row"],["name","storefront-outline","color","primary"],[1,"vendor-text"],[1,"description-text"],[1,"price-row"],[1,"current-price"],["class","savings-container",4,"ngIf"],["slot","end","color","danger",4,"ngIf"],[1,"savings-container"],[1,"old-price"],[1,"savings-amount"],["slot","end","color","danger"]],template:function(r,c){r&1&&(o(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),s(3,"Listado de Chollos"),e()(),o(4,"ion-toolbar",1)(5,"ion-searchbar",2),x("ionInput",function(U){return c.buscar(U)}),e()()(),o(6,"ion-content")(7,"ion-list",3),d(8,J,17,7,"ion-item",4),e()()),r&2&&(a(8),p("ngForOf",c.filtrados))},dependencies:[w,M,v,E,F,L,S,k,T,D,z,y,N,A,I],styles:["ion-content[_ngcontent-%COMP%]{--background: #ffffff}ion-list[_ngcontent-%COMP%]{background:transparent;padding:4px}.chollo-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--background: #ffffff;--min-height: 90px;margin-bottom:8px;border-bottom:1px solid #f2f2f2}.chollo-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:85px;height:85px;margin:8px;border-radius:6px;overflow:hidden}.chollo-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:8px 10px 8px 0}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;color:#1a1a1b;font-size:.95rem;white-space:normal;margin-bottom:4px;line-height:1.2}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;margin-bottom:2px}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:13px;color:var(--ion-color-primary)}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .vendor-text[_ngcontent-%COMP%]{font-weight:600;font-size:.75rem;color:var(--ion-color-primary)}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{font-size:.75rem;color:#5f6368;margin-bottom:6px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0px}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .current-price[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:800;color:#1a1a1b}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .savings-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .savings-container[_ngcontent-%COMP%]   .old-price[_ngcontent-%COMP%]{font-size:.85rem;text-decoration:line-through;color:#70757a;font-weight:400}.chollo-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .savings-container[_ngcontent-%COMP%]   .savings-amount[_ngcontent-%COMP%]{font-size:.85rem;color:#d93025;font-weight:600}.chollo-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;--background: #d93025;font-weight:700;font-size:.65rem;padding:3px 6px;border-radius:4px}ion-searchbar[_ngcontent-%COMP%]{--border-radius: 8px;--box-shadow: none;--background: #f1f3f4;--height: 36px;padding:4px 12px}"]});let i=l;return i})();export{nn as Tab4Page};
