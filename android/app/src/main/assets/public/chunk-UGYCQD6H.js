import{a as tt}from"./chunk-IG5WGN65.js";import{a as R,b as G,d as J,f as W,g as K,k as Q,m as X,n as Y,r as Z}from"./chunk-TIRIOUTJ.js";import{a as H}from"./chunk-CAWAZEOC.js";import{e as D,f as V,i as L,k as N,u as U,x as $,y as B}from"./chunk-AYIUP6ED.js";import{$ as r,A as E,E as f,H as s,I as t,J as n,K as d,Q as y,R as b,S as x,Z as I,_ as F,aa as m,ba as u,ga as C,ha as O,ka as z,la as T,na as q,o as w,oa as A,p as M,sa as j,v as h,w as o,y as _}from"./chunk-5MEF2J7Q.js";import"./chunk-W7HPUEKP.js";import"./chunk-5UWQKTRJ.js";import"./chunk-254F5RPF.js";import"./chunk-PZU7R7Y5.js";import"./chunk-YN4SZ4GL.js";import"./chunk-UQSJFG5S.js";import"./chunk-O6FA337S.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as S,b as k,f as v}from"./chunk-D7YYRZS5.js";function et(l,p){if(l&1&&(t(0,"div",30),d(1,"img",31),t(2,"div",32),r(3),n(),t(4,"div",33),r(5,"Comprar ahora"),n()()),l&2){let e=p.$implicit;o(),s("src",e.img,h),o(2),m(e.title)}}function nt(l,p){l&1&&(t(0,"div",49),r(1,"Nuevo"),n())}function it(l,p){if(l&1&&(t(0,"div",50),r(1),n()),l&2){let e=x().$implicit;o(),u("",e.descuento,"%")}}function ot(l,p){if(l&1&&(t(0,"span",51),r(1),n()),l&2){let e=x().$implicit;o(),u("",e.precioOriginal,"\u20AC")}}function rt(l,p){if(l&1){let e=y();t(0,"div",34),f(1,nt,2,0,"div",35)(2,it,2,1,"div",36),d(3,"img",37),t(4,"div",38)(5,"div",39),r(6),n(),t(7,"div",40),r(8),n(),t(9,"div",41),r(10),n(),t(11,"div",42)(12,"span",43),r(13),n(),f(14,ot,2,1,"span",44),n(),t(15,"button",45),r(16),n(),t(17,"button",46),r(18,"A\xF1adir al carrito"),n(),t(19,"div",47),b("click",function(c){let i=w(e).$implicit,g=x();return M(g.toggleFavorito(i,c))}),d(20,"ion-icon",48),n()()()}if(l&2){let e=p.$implicit,a=x();o(),s("ngIf",e.nuevo),o(),s("ngIf",e.descuento),o(),s("src",e.imagen,h),o(3),m(e.categoria),o(2),m(e.titulo),o(2),m(e.proveedor),o(3),u("",e.precioActual,"\u20AC"),o(),s("ngIf",e.precioOriginal),o(2),u("+ ",e.precioActual," \u20AC"),o(4),s("name",a.isFavorito(e.id)?"heart":"heart-outline")}}function at(l,p){if(l&1){let e=y();t(0,"div",52)(1,"div",53),r(2),n(),t(3,"div",54),b("click",function(c){let i=w(e).$implicit,g=x();return M(g.toggleFavorito(i,c))}),d(4,"ion-icon",48),n(),d(5,"img",55),t(6,"div",56)(7,"div",57),d(8,"img",58),t(9,"span"),r(10),n()(),t(11,"div",59),r(12),n(),t(13,"div",60)(14,"span",61),r(15),C(16,"number"),n(),t(17,"span",62),r(18),C(19,"number"),n()(),t(20,"button",63),r(21),C(22,"number"),n()()()}if(l&2){let e=p.$implicit,a=x();o(),F("badge-hot",(e==null||e.punto==null?null:e.punto.estado)==="Caliente"),o(),u(" ",a.calcDescuento(e),"% "),o(2),s("name",a.isFavorito(e.id)?"heart":"heart-outline"),o(),s("src",(e==null?null:e.imagen)||"https://images.unsplash.com/photo-1523275335684-37898b6baf30?q=80&w=1200&auto=format&fit=crop",h),o(3),s("src",e==null||e.proveedor==null?null:e.proveedor.logo,h),o(2),m(e==null||e.proveedor==null?null:e.proveedor.nombre),o(2),m(e==null?null:e.titulo),o(3),u("",O(16,11,e==null?null:e.precio_actual,"1.2-2"),"\u20AC"),o(3),u("",O(19,14,e==null?null:e.precio_original,"1.2-2"),"\u20AC"),o(3),u("+ ",O(22,17,e==null?null:e.precio_actual,"1.0-0")," \u20AC")}}function ct(l,p){if(l&1&&(t(0,"div",64),d(1,"img",31),t(2,"div"),r(3),n()()),l&2){let e=p.$implicit;o(),s("src",e.img,h),o(2),m(e.nombre)}}var vt=(()=>{let p=class p{constructor(a,c,i){this.supabaseService=a,this.favoritosEvent=c,this.router=i,this.cartCount=0,this.bannerUrl="https://images.unsplash.com/photo-1607083206968-13611e3d76db?q=80&w=1400&auto=format&fit=crop",this.quickLinks=[{title:"Ofertas del d\xEDa",img:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=600&auto=format&fit=crop"},{title:"Servicios",img:"https://images.unsplash.com/photo-1556761175-4b46a572b786?q=80&w=600&auto=format&fit=crop"},{title:"Deporte -20%",img:"https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=600&auto=format&fit=crop"}],this.productosPopulares=[],this.chollosFiltrados=[],this.categorias=[{nombre:"Belleza",img:"https://cdn-icons-png.flaticon.com/512/2964/2964514.png"},{nombre:"Moda",img:"https://cdn-icons-png.flaticon.com/512/892/892458.png"},{nombre:"Mascotas",img:"https://cdn-icons-png.flaticon.com/512/616/616408.png"},{nombre:"Cocina",img:"https://cdn-icons-png.flaticon.com/512/1046/1046784.png"},{nombre:"Marketing",img:"https://cdn-icons-png.flaticon.com/512/3135/3135683.png"},{nombre:"Juguetes",img:"https://cdn-icons-png.flaticon.com/512/3082/3082060.png"}],this.favoritosIds=new Set,R({searchOutline:Y,heartOutline:K,heart:W,personOutline:X,bagOutline:G,flameOutline:J,timeOutline:Z,openOutline:Q})}ngOnInit(){return v(this,null,function*(){yield this.cargarDatos(),yield this.cargarFavoritos()})}ionViewWillEnter(){return v(this,null,function*(){yield this.cargarFavoritos()})}cargarDatos(){return v(this,null,function*(){try{let c=(yield this.supabaseService.getChollos()).map(i=>k(S({},i),{titulo:i.titulo,precioActual:i.precio_actual,precioOriginal:i.precio_original,imagen:i.imagen_url,proveedor:i.proveedores?.nombre,nuevo:this.esReciente(i.created_at)}));this.productosPopulares=c,this.chollosFiltrados=[...c]}catch(a){console.error("Error al cargar datos:",a)}})}cargarFavoritos(){return v(this,null,function*(){try{let a=yield this.supabaseService.getFavoritosIds();this.favoritosIds=new Set(a)}catch(a){console.error("Error al cargar favoritos:",a)}})}onSearch(a){let c=(a?.target?.value||"").toLowerCase().trim();if(!c){this.chollosFiltrados=[...this.productosPopulares];return}this.chollosFiltrados=this.productosPopulares.filter(i=>(i.titulo||"").toLowerCase().includes(c)||(i.proveedor||"").toLowerCase().includes(c))}irAGuardados(){this.router.navigate(["/tabs/tab3"])}toggleFavorito(a,c){return v(this,null,function*(){c&&c.stopPropagation();let i=a.id,g=this.isFavorito(i);g?this.favoritosIds.delete(i):this.favoritosIds.add(i);try{g?yield this.supabaseService.eliminarCholloFavorito(i):yield this.supabaseService.guardarCholloFavorito(i),this.favoritosEvent.notificarCambio()}catch(P){console.error("Error al gestionar favorito (revertiendo):",P),g?this.favoritosIds.add(i):this.favoritosIds.delete(i)}})}isFavorito(a){return this.favoritosIds.has(a)}esReciente(a){return a?(new Date().getTime()-new Date(a).getTime())/(1e3*60*60)<24:!1}calcDescuento(a){let c=Number(a?.precio_actual||0),i=Number(a?.precio_original||0);return!c||!i||i<=c?0:Math.round((i-c)/i*100)}};p.\u0275fac=function(c){return new(c||p)(_(H),_(tt),_(j))},p.\u0275cmp=E({type:p,selectors:[["app-tab1"]],decls:59,vars:7,consts:[["translucent","true",1,"header-red"],[1,"topbar"],[1,"brand"],[1,"search-wrap"],["placeholder","Buscar cualquier cosa",1,"searchbar",3,"ionInput"],["slot","end"],["fill","clear",3,"click"],["name","heart-outline"],["fill","clear"],["name","person-outline"],["fill","clear",1,"cart-btn"],["name","bag-outline"],[1,"cart-badge"],[1,"banner"],[1,"banner-overlay"],[1,"banner-kicker"],[1,"banner-title"],[1,"banner-sub"],[1,"banner-btn"],[1,"section"],[1,"section-title"],[1,"link"],[1,"quick-grid"],["class","quick-item",4,"ngFor","ngForOf"],[1,"popular-row"],["class","product-card",4,"ngFor","ngForOf"],[1,"cards-row"],["class","chollo-card",4,"ngFor","ngForOf"],[1,"cat-strip"],["class","cat-item",4,"ngFor","ngForOf"],[1,"quick-item"],[3,"src"],[1,"quick-text"],[1,"quick-cta"],[1,"product-card"],["class","pill",4,"ngIf"],["class","disc",4,"ngIf"],[1,"product-img",3,"src"],[1,"product-body"],[1,"product-cat"],[1,"product-title"],[1,"product-prov"],[1,"product-prices"],[1,"p-now"],["class","p-old",4,"ngIf"],[1,"btn-buy"],[1,"btn-cart"],[1,"fav",3,"click"],[3,"name"],[1,"pill"],[1,"disc"],[1,"p-old"],[1,"chollo-card"],[1,"badge"],[1,"fav-icon",3,"click"],[1,"cover",3,"src"],[1,"meta"],[1,"provider"],[1,"logo",3,"src"],[1,"title"],[1,"prices"],[1,"now"],[1,"old"],[1,"btn-add"],[1,"cat-item"]],template:function(c,i){c&1&&(t(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"div",2),r(4,"CHOLLONES"),n(),t(5,"div",3)(6,"ion-searchbar",4),b("ionInput",function(P){return i.onSearch(P)}),n()(),t(7,"ion-buttons",5)(8,"ion-button",6),b("click",function(){return i.irAGuardados()}),d(9,"ion-icon",7),n(),t(10,"ion-button",8),d(11,"ion-icon",9),n(),t(12,"ion-button",10),d(13,"ion-icon",11),t(14,"span",12),r(15),n()()()()()(),t(16,"ion-content")(17,"div",13)(18,"div",14)(19,"div",15),r(20,"CHOLLONES"),n(),t(21,"div",16),r(22,"Los mejores chollos cerca de ti"),n(),t(23,"div",17),r(24,"Ahorra en productos y servicios en un solo clic"),n(),t(25,"button",18),r(26,"Ver ofertas"),n()()(),t(27,"div",19)(28,"div",20)(29,"h3"),r(30,"\xDAltimas ofertas"),n(),t(31,"a",21),r(32,"Ver todas"),n()(),t(33,"div",22),f(34,et,6,2,"div",23),n()(),t(35,"div",19)(36,"div",20)(37,"h3"),r(38,"Productos populares"),n(),t(39,"a",21),r(40,"Ver todos"),n()(),t(41,"div",24),f(42,rt,21,10,"div",25),n()(),t(43,"div",19)(44,"div",20)(45,"h3"),r(46,"Nuestros chollos"),n(),t(47,"a",21),r(48,"Ver todos"),n()(),t(49,"div",26),f(50,at,23,20,"div",27),n()(),t(51,"div",19)(52,"div",20)(53,"h3"),r(54,"Categor\xEDas m\xE1s populares"),n(),t(55,"a",21),r(56,"Ver todas"),n()(),t(57,"div",28),f(58,ct,4,2,"div",29),n()()()),c&2&&(o(15),m(i.cartCount),o(2),I("background-image","url("+i.bannerUrl+")"),o(17),s("ngForOf",i.quickLinks),o(8),s("ngForOf",i.productosPopulares),o(8),s("ngForOf",i.chollosFiltrados),o(8),s("ngForOf",i.categorias))},dependencies:[A,z,T,N,U,L,B,V,D,$,q],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: #f4f5f8}.header-red[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff}.topbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 10px}.brand[_ngcontent-%COMP%]{font-weight:900;letter-spacing:1px;white-space:nowrap;color:#fff}.search-wrap[_ngcontent-%COMP%]{flex:1}.searchbar[_ngcontent-%COMP%]{--border-radius: 999px;--background: rgba(255,255,255,.95);--color: #111;--placeholder-color: #666;--icon-color: #666}ion-button[_ngcontent-%COMP%]{--color: #fff}.cart-btn[_ngcontent-%COMP%]{position:relative}.cart-badge[_ngcontent-%COMP%]{position:absolute;top:2px;right:2px;background:#fff;color:var(--ion-color-primary);font-weight:900;font-size:10px;min-width:16px;height:16px;border-radius:999px;display:flex;align-items:center;justify-content:center}.section[_ngcontent-%COMP%]{padding:14px}.section-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline;margin:6px 0 12px}.section-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:900}.section-title[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{font-size:13px;text-decoration:underline;font-weight:700;color:#111}.quick-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.quick-item[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:14px;text-align:center;box-shadow:0 8px 20px #00000014}.quick-item[_ngcontent-%COMP%]   .quick-text[_ngcontent-%COMP%]{font-weight:900;font-size:14px;line-height:1.2;margin-bottom:8px}.quick-item[_ngcontent-%COMP%]   .quick-cta[_ngcontent-%COMP%]{font-size:12px;text-decoration:underline;font-weight:700;opacity:.9}.banner[_ngcontent-%COMP%]{margin:14px;height:180px;border-radius:18px;background:url(https://images.unsplash.com/photo-1607083206968-13611e3d76db?q=80&w=1200) center/cover no-repeat;position:relative;overflow:hidden;box-shadow:0 12px 30px #0000001f}.banner-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(90deg,#0000008c,#0000000d);padding:18px;color:#fff;display:flex;flex-direction:column;justify-content:center}.banner-kicker[_ngcontent-%COMP%]{font-weight:900;letter-spacing:1px;opacity:.9;font-size:12px}.banner-title[_ngcontent-%COMP%]{font-size:20px;font-weight:900;margin-top:6px;line-height:1.1}.banner-sub[_ngcontent-%COMP%]{font-size:12px;opacity:.9;margin-top:6px;max-width:240px}.banner-btn[_ngcontent-%COMP%]{margin-top:12px;width:fit-content;border:0;background:var(--ion-color-secondary);color:#fff;font-weight:900;padding:10px 14px;border-radius:12px}.popular-row[_ngcontent-%COMP%]{display:flex;gap:14px;overflow-x:auto;padding-bottom:8px}.product-card[_ngcontent-%COMP%]{min-width:260px;background:#fff;border-radius:18px;box-shadow:0 12px 30px #0000001a;overflow:hidden;position:relative}.pill[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;background:#34d399;color:#fff;font-weight:900;font-size:12px;padding:4px 10px;border-radius:999px;z-index:2}.disc[_ngcontent-%COMP%]{position:absolute;top:10px;left:82px;background:var(--ion-color-primary);color:#fff;font-weight:900;font-size:12px;padding:4px 10px;border-radius:999px;z-index:2}.product-img[_ngcontent-%COMP%]{width:100%;height:170px;object-fit:cover;background:#f2f2f2}.product-body[_ngcontent-%COMP%]{padding:12px}.product-cat[_ngcontent-%COMP%]{font-size:12px;opacity:.7;margin-bottom:6px}.product-title[_ngcontent-%COMP%]{font-size:14px;font-weight:900;line-height:1.15;margin-bottom:6px}.product-prov[_ngcontent-%COMP%]{font-size:12px;opacity:.75;margin-bottom:10px}.product-prices[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:baseline;margin-bottom:10px}.p-now[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:900}.p-old[_ngcontent-%COMP%]{color:#999;text-decoration:line-through;font-size:13px}.btn-buy[_ngcontent-%COMP%]{width:100%;border:0;padding:12px;border-radius:12px;background:var(--ion-color-secondary);color:#fff;font-weight:900}.btn-cart[_ngcontent-%COMP%]{width:100%;border:0;margin-top:10px;padding:12px;border-radius:14px;background:var(--ion-color-primary);color:#fff;font-weight:900}.fav[_ngcontent-%COMP%]{text-align:center;margin-top:10px;cursor:pointer;transition:transform .2s ease}.fav[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--ion-color-primary)}.fav[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.fav[_ngcontent-%COMP%]:active{transform:scale(.95)}.cards-row[_ngcontent-%COMP%]{display:flex;gap:14px;overflow-x:auto;padding-bottom:8px}.chollo-card[_ngcontent-%COMP%]{min-width:260px;background:#fff;border-radius:18px;box-shadow:0 12px 30px #0000001a;overflow:hidden;position:relative}.badge[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;background:var(--ion-color-primary);color:#fff;font-weight:900;font-size:12px;padding:4px 10px;border-radius:999px;z-index:2}.badge.badge-hot[_ngcontent-%COMP%]{background:#ff6b6b}.fav-icon[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;z-index:3;cursor:pointer;background:#ffffffe6;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.fav-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-primary)}.fav-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1);background:#fff}.fav-icon[_ngcontent-%COMP%]:active{transform:scale(.95)}.cover[_ngcontent-%COMP%]{width:100%;height:170px;object-fit:cover;background:#f2f2f2}.meta[_ngcontent-%COMP%]{padding:12px}.provider[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.provider[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:24px;height:24px;object-fit:contain}.provider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;opacity:.7}.title[_ngcontent-%COMP%]{font-size:14px;font-weight:900;line-height:1.15;margin-bottom:8px}.prices[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:baseline;margin-bottom:10px}.prices[_ngcontent-%COMP%]   .now[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:900;font-size:18px}.prices[_ngcontent-%COMP%]   .old[_ngcontent-%COMP%]{color:#999;text-decoration:line-through;font-size:13px}.btn-add[_ngcontent-%COMP%]{width:100%;border:0;padding:12px;border-radius:12px;background:var(--ion-color-primary);color:#fff;font-weight:900;cursor:pointer}.cat-strip[_ngcontent-%COMP%]{display:flex;gap:12px;overflow-x:auto;padding-bottom:8px}.cat-item[_ngcontent-%COMP%]{min-width:140px;background:#fff;border-radius:18px;padding:14px;text-align:center;box-shadow:0 10px 25px #00000014}.cat-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70px;height:70px;object-fit:contain;margin:0 auto 10px;display:block}.cat-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-weight:900;font-size:13px}']});let l=p;return l})();export{vt as Tab1Page};
